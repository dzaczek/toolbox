object CheckCommand "opensearch_health" {
    import "plugin-check-command"

    // Point this to where you saved the script
    command = [ PluginDir + "/check_opensearch.pl" ]

    arguments = {
        "-H" = {
            value = "$opensearch_address$"
            description = "Host address (defaults to host.address if not set)"
        }
        "-P" = {
            value = "$opensearch_port$"
            description = "OpenSearch Port"
        }
        "-u" = {
            value = "$opensearch_user$"
            description = "Username"
        }
        "-p" = {
            value = "$opensearch_password$"
            description = "Password"
        }
        "--ssl" = {
            set_if = "$opensearch_ssl$"
            description = "Enable HTTPS"
        }
        "--insecure" = {
            set_if = "$opensearch_insecure$"
            description = "Ignore Self-Signed Certs"
        }
        "--heap-warn" = {
            value = "$opensearch_heap_warn$"
            description = "Heap Warning Threshold %"
        }
        "--heap-crit" = {
            value = "$opensearch_heap_crit$"
            description = "Heap Critical Threshold %"
        }
        "--nodes" = {
            value = "$opensearch_min_nodes$"
            description = "Expected number of nodes (Alerts if fewer)"
        }
    }

    // Default variable values if not defined in the Host object
    vars.opensearch_address = "$address$"
    vars.opensearch_port = 9200
    vars.opensearch_ssl = false
    vars.opensearch_insecure = false 
}
